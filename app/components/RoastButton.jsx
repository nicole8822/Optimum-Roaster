"use client";
import { useState } from "react";
import { motion } from "framer-motion";
import html2canvas from "html-to-image";
import { saveAs } from "file-saver";

const roastLines = [
  "Your node uptime is lower than your self-esteem.",
    "You say youâ€™re decentralized, but youâ€™re always in her DMs.",
      "You forked twice and still didnâ€™t improve performance.",
        "You propagate slower than grandmaâ€™s Wi-Fi.",
          "Optimum calledâ€”said your latency is embarrassing.",
            "Your packets get dropped more than your mixtapes.",
              "Even Optimumâ€™s mumP2P canâ€™t propagate your personality.",
                "You debug like youâ€™re in denial.",
                  "Even Solidity throws fewer errors than you do.",
                    "You coded your life in spaghetti logic.",
                      "You commit to GitHub more than you commit to relationships.",
                        "You bought the top and sold the rumor.",
                          "Your liquidity pool is 99% tears.",
                            "You diversify your regrets, not your portfolio.",
                              "Even MEV bots avoid your trades.",
                                "You talk decentralization, but centralize your excuses.",
                                  "Your reliability score is -404.",
                                    "Even Optimum canâ€™t optimize that attitude.",
                                      "Your nodeâ€™s asleep â€” like your ambition.",
                                        "You need a reorg in your life.",
                                          "Youâ€™re like testnet rewards â€” promised, never delivered.",
                                            "You optimize nothing but chaos.",
                                              "You got rug-pulled by common sense.",
                                                "Your aura screams 'pending transaction.'",
                                                  "Your energy glows blue but your effort barely loads.",
                                                    "Validator core: 2%. Ego core: 98%.",
                                                      "Youâ€™ve been optimized for disappointment.",
                                                        "Memory waves unstable. Confidence missing.",
                                                          "Aura level: testnet-tier.",
                                                            "Youâ€™re proof block propagation isnâ€™t instant.",
                                                              "Even your crush slashed your stake.",
                                                                "Youâ€™re a validator with no delegation.",
                                                                  "You gossip more than Ethereum but say less.",
                                                                    "Your throughput is fineâ€¦ if weâ€™re measuring disappointment.",
                                                                      "You lag harder than a Discord stream on hotel Wi-Fi.",
                                                                        "You compress data but inflate your ego.",
                                                                          "Your brain needs a firmware update.",
                                                                            "Youâ€™re still console.logging your feelings.",
                                                                              "Youâ€™re like an RPC outage with feelings.",
                                                                                "Youâ€™re not even in the mempool.",
                                                                                  "You scale horizontally and still fall short vertically.",
                                                                                    "You optimize for drama, not performance.",
                                                                                      "You need a reboot, not therapy.",
                                                                                        "Youâ€™re gasless â€” both ways.",
                                                                                          "Even your shadow unsubscribed.",
                                                                                            "Youâ€™re proof 'beta' can be permanent.",
                                                                                              "Aura detected: broke but hopeful.",
                                                                                                "Your signals bounce like your attention span.",
                                                                                                  "You reached consensus... with failure.",
                                                                                                    "Validator core overheated. Try again later.",
                                                                                                      "You fork drama, not repos.",
                                                                                                        "Your auraâ€™s blue, your vibeâ€™s off-chain.",
                                                                                                          "Youâ€™d fail a ping test to reality.",
                                                                                                            "Youâ€™re a single point of failure in human form.",
                                                                                                              "Even your packets left for faster routes.",
                                                                                                                "Optimum would throttle your attitude.",
                                                                                                                  "You buffer through every conversation.",
                                                                                                                    "Youâ€™re proof redundancy has limits.",
                                                                                                                      "You need less latency and more therapy.",
                                                                                                                        "Your blocks never finalize.",
                                                                                                                          "Youâ€™d get slashed in a trust fall.",
                                                                                                                            "Consensus failed: too emotional.",
                                                                                                                              "Youâ€™re an unverified node in every sense.",
                                                                                                                                "Your PFP has more confidence than you.",
                                                                                                                                  "You dropped your stake and your standards.",
                                                                                                                                    "Aura syncing... forever.",
                                                                                                                                      "Your meme hash rate is below testnet.",
                                                                                                                                        "Reorg detected â€” your personality.",
                                                                                                                                          "Your uptime report says 'lol.'",
                                                                                                                                            "Bandwidth: none. Opinions: plenty.",
                                                                                                                                              "Packet loss = life story.",
                                                                                                                                                "You gossip without propagation.",
                                                                                                                                                  "Your auraâ€™s blue but your walletâ€™s red.",
                                                                                                                                                    "You forked your feelings.",
                                                                                                                                                      "RPC call failed â€” emotional overload.",
                                                                                                                                                        "Even your validator ghosted you.",
                                                                                                                                                          "You scale like Solana on a bad day.",
                                                                                                                                                            "Optimum canâ€™t optimize this mess.",
                                                                                                                                                              "Youâ€™re not decentralized, youâ€™re just lost.",
                                                                                                                                                                "Your logs say 'bro what are you doing.'",
                                                                                                                                                                  "You lag IRL.",
                                                                                                                                                                    "Node reputation: clown-tier.",
                                                                                                                                                                      "Your auraâ€™s cached, not real.",
                                                                                                                                                                        "Youâ€™d timeout in a conversation.",
                                                                                                                                                                          "Gas price of your ego: unaffordable.",
                                                                                                                                                                            "Even latency avoids you.",
                                                                                                                                                                              "You propagate excuses faster than blocks.",
                                                                                                                                                                                "Your validator report says 'bro stop.'",
                                                                                                                                                                                  "You talk bandwidth, but youâ€™re static.",
                                                                                                                                                                                    "Even your aura rate-limited you.",
                                                                                                                                                                                      "You broadcast, no one listens.",
                                                                                                                                                                                        "Youâ€™re an edge node for bad takes.",
                                                                                                                                                                                          "RPC disconnected â€” user error.",
                                                                                                                                                                                            "You talk consensus, but youâ€™re divided internally.",
                                                                                                                                                                                              "Block height: emotionally low.",
                                                                                                                                                                                                "Aura corrupted: missing self-worth.",
                                                                                                                                                                                                  "Optimum roasted you, automatically.",
                                                                                                                                                                                                    "Protocol suggestion: touch grass."
                                                                                                                                                                                                    ];

                                                                                                                                                                                                    export default function RoastButton() {
                                                                                                                                                                                                      const [image, setImage] = useState(null);
                                                                                                                                                                                                        const [roast, setRoast] = useState("");

                                                                                                                                                                                                          const handleRoast = () => {
                                                                                                                                                                                                              if (!image) return alert("Upload your image first!");
                                                                                                                                                                                                                  const randomRoast = roastLines[Math.floor(Math.random() * roastLines.length)];
                                                                                                                                                                                                                      setRoast(randomRoast);
                                                                                                                                                                                                                        };

                                                                                                                                                                                                                          const handleDownload = async () => {
                                                                                                                                                                                                                              const node = document.getElementById("roast-result");
                                                                                                                                                                                                                                  const blob = await html2canvas.toBlob(node);
                                                                                                                                                                                                                                      saveAs(blob, "optimum_roast.png");
                                                                                                                                                                                                                                        };

                                                                                                                                                                                                                                          return (
                                                                                                                                                                                                                                              <div className="flex flex-col items-center gap-4 mt-6">
                                                                                                                                                                                                                                                    <input
                                                                                                                                                                                                                                                            type="file"
                                                                                                                                                                                                                                                                    accept="image/*"
                                                                                                                                                                                                                                                                            onChange={(e) => setImage(URL.createObjectURL(e.target.files[0]))}
                                                                                                                                                                                                                                                                                    className="p-2 border border-gray-300 rounded-lg"
                                                                                                                                                                                                                                                                                          />

                                                                                                                                                                                                                                                                                                <motion.button
                                                                                                                                                                                                                                                                                                        whileTap={{ scale: 0.95 }}
                                                                                                                                                                                                                                                                                                                onClick={handleRoast}
                                                                                                                                                                                                                                                                                                                        className="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold shadow-md"
                                                                                                                                                                                                                                                                                                                              >
                                                                                                                                                                                                                                                                                                                                      Roast Me ðŸ”¥
                                                                                                                                                                                                                                                                                                                                            </motion.button>

                                                                                                                                                                                                                                                                                                                                                  {roast && (
                                                                                                                                                                                                                                                                                                                                                          <div
                                                                                                                                                                                                                                                                                                                                                                    id="roast-result"
                                                                                                                                                                                                                                                                                                                                                                              className="mt-6 p-4 bg-gray-900 text-white rounded-xl shadow-lg text-center"
                                                                                                                                                                                                                                                                                                                                                                                      >
                                                                                                                                                                                                                                                                                                                                                                                                <img
                                                                                                                                                                                                                                                                                                                                                                                                            src={image}
                                                                                                                                                                                                                                                                                                                                                                                                                        alt="Uploaded"
                                                                                                                                                                                                                                                                                                                                                                                                                                    className="max-w-xs mx-auto rounded-xl mb-4"
                                                                                                                                                                                                                                                                                                                                                                                                                                              />
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <p className="text-lg font-medium">{roast}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <p className="text-sm text-gray-400 mt-3">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              made with love by nicole2288 ðŸ’™ and beginner
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </p>

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <button
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              onClick={handleDownload}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          className="mt-3 bg-gray-700 hover:bg-gray-800 text-sm px-4 py-2 rounded-lg"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Share on X
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </button>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        )}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              );
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }